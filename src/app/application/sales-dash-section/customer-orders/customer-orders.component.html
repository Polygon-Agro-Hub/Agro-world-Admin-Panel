<app-loading-spinner *ngIf="isLoading"></app-loading-spinner>

<button class="mb-5 text-textLight dark:text-textDark" (click)="back()">
    <i class="fa-solid fa-arrow-left"></i>
    Back
</button>

<div
    class="fixed-width-container overflow-x-auto scrollbar-thin scrollbar-thumb-scrollBarColor scrollbar-track-transparent scrollbar-thumb-rounded-full">
    <div class="pt-5 pb-5 min-w-[1200px] bg-white dark:bg-tileBlack shadow-lg rounded-lg">
        <div class="flex space-x-4 pb-5 pr-12 pl-12 border-b border-gray-300">
            <button [ngClass]="
          activeButton === 'assigned'
            ? 'border border-[#415CFF] text-[#415CFF]'
            : 'border border-gray-300 text-textLight dark:text-textDark'
        " class="h-10 px-5 flex items-center justify-center rounded-full gap-2" (click)="onStatusChange('assigned')">
                <i *ngIf="activeButton === 'assigned'" class="fa fa-check"></i>
                Assigned
            </button>
            <button [ngClass]="
          activeButton === 'processing'
            ? 'border border-[#415CFF] text-[#415CFF]'
            : 'border border-gray-300 text-textLight dark:text-textDark'
        " class="h-10 px-5 flex items-center justify-center rounded-full gap-2" (click)="onStatusChange('processing')">
                <i *ngIf="activeButton === 'processing'" class="fa fa-check"></i>
                Processing
            </button>
            <button [ngClass]="
          activeButton === 'delivered'
            ? 'border border-[#415CFF] text-[#415CFF]'
            : 'border border-gray-300 text-textLight dark:text-textDark'
        " class="h-10 px-5 flex items-center justify-center rounded-full gap-2" (click)="onStatusChange('delivered')">
                <i *ngIf="activeButton === 'delivered'" class="fa fa-check"></i>
                Delivered
            </button>
            <button [ngClass]="
          activeButton === 'On the way'
            ? 'border border-[#415CFF] text-[#415CFF]'
            : 'border border-gray-300 text-textLight dark:text-textDark'
        " class="h-10 px-5 flex items-center justify-center rounded-full gap-2" (click)="onStatusChange('Out For Delivery')">
                <i *ngIf="activeButton === 'Out For Delivery'" class="fa fa-check"></i>
                Out For Delivery
            </button>
            <button [ngClass]="
          activeButton === 'cancelled'
            ? 'border border-[#415CFF] text-[#415CFF]'
            : 'border border-gray-300 text-textLight dark:text-textDark'
        " class="h-10 px-5 flex items-center justify-center rounded-full gap-2" (click)="onStatusChange('cancelled')">
                <i *ngIf="activeButton === 'cancelled'" class="fa fa-check"></i>
                Cancelled
            </button>
            <button [ngClass]="
          activeButton === 'failed'
            ? 'border border-[#415CFF] text-[#415CFF]'
            : 'border border-gray-300 text-textLight dark:text-textDark'
        " class="h-10 px-5 flex items-center justify-center rounded-full gap-2" (click)="onStatusChange('failed')">
                <i *ngIf="activeButton === 'failed'" class="fa fa-check"></i>
                Failed
            </button>
        </div>

        <div class="h-5"></div>

        <!-- Loading indicator -->
        <div *ngIf="isLoading" class="flex justify-center p-8">
            <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-[#415CFF]"></div>
        </div>

        <div *ngIf="!hasData" class="flex flex-col items-center w-full h-screen px-10 py-7 mt-6 ">
            <p class="text-[#494949] my-6 dark:text-textDark">--No Data Available--</p>
            <img src="assets/images/NoData.png" alt="No Data" class="w-20 h-20" />
        </div>

        <div class="px-5" *ngIf="!isLoading && !errorMessage && hasData">
            <table class="min-w-full divide-y divide-gray-200 dark:divide-[#4B555A] table-auto">
                <thead>
                    <tr>
                        <th class="px-3 py-3 font-normal text-textLight dark:text-textDark text-left">
                            Invoice No
                        </th>
                        <th class="px-3 py-3 font-normal text-textLight dark:text-textDark text-left">
                            Order Type
                        </th>
                        <th class="px-3 py-3 font-normal text-textLight dark:text-textDark text-center">
                            Order Time
                        </th>
                        <th class="px-3 py-3 font-normal text-textLight dark:text-textDark text-left">
                            Schedule
                        </th>
                        <th class="px-3 py-3 font-normal text-textLight dark:text-textDark text-center">
                            Payment
                        </th>
                        <th class="px-3 py-3 font-normal text-textLight dark:text-textDark text-center">
                            Payment Status
                        </th>
                        <th class="px-3 py-3 font-normal text-textLight dark:text-textDark text-center">
                            Amount
                        </th>
                        <th class="px-3 py-3 font-normal text-textLight dark:text-textDark text-center">
                            Order Status
                        </th>
                        <th class="px-3 py-3 font-normal text-textLight dark:text-textDark text-center">
                            Invoice
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <ng-container *ngIf="orders && orders.length > 0; else noData">
                        <tr *ngFor="let order of orders" class="border-b border-gray-200 dark:border-[#4B555A]">
                            <td class="px-3 py-3 text-left dark:text-textDark">{{ order.invNo }}</td>
                            <td class="px-3 py-3 text-left dark:text-textDark">
                                <span *ngIf="order.isPackage === 1">Package</span>
                                <span *ngIf="order.isPackage === 0">Custom</span>
                            </td>
                            <td class="px-3 py-3 text-center dark:text-textDark">
                                {{ order.sheduleDate | date : "d MMM, y h:mm a" }}
                            </td>
                            <td class="px-3 py-3 text-left dark:text-textDark">{{ order.sheduleType }}</td>
                            <td class="px-3 py-3 text-center dark:text-textDark">{{ order.paymentMethod }}</td>
                            <td class="px-3 py-3 text-center">
                                <!-- <span
                  [class]="order.isPaid ? 'text-green-500' : 'text-red-500'"
                >
                  {{ order.isPaid ? "Paid" : "Pending" }}
                </span> -->
                                <span *ngIf="order.isPaid === 1"
                                    class="bg-[#BBFFC6] text-[#308233] rounded-xl px-7 py-2">Paid</span>
                                <span *ngIf="order.isPaid === 0"
                                    class="bg-[#DFDFDF] text-[#5C5C5C] rounded-xl px-4 py-2">Pending</span>
                            </td>
                            <td class="px-3 py-3 text-center dark:text-textDark">
                                {{ order.fullTotal | number : "1.2-2" }}
                            </td>
                            <td class="px-3 py-3 text-center">
                                <span *ngIf="activeButton === 'assigned'"
                                    class="bg-[#F5FF85] text-[#878216] rounded-xl px-5 py-2">Assigned</span>
                                <span *ngIf="activeButton === 'processing'"
                                    class="bg-[#CFE1FF] text-[#3B82F6] rounded-xl px-5 py-2">Processing</span>
                                <span *ngIf="activeButton === 'delivered'"
                                    class="bg-[#BBFFC6] text-[#308233] rounded-xl px-5 py-2">Delivered</span>
                                <span *ngIf="activeButton === 'Out For Delivery'"
                                    class="bg-[#af7ce3] text-[#481c56] rounded-xl px-5 py-2">Out For Delivery</span>
                                <span *ngIf="activeButton === 'cancelled'"
                                    class="bg-[#DFDFDF] text-[#5C5C5C] rounded-xl px-5 py-2">Cancelled</span>
                                <span *ngIf="activeButton === 'failed'"
                                    class="bg-[#FFDCDA] text-[#FF1100] rounded-xl px-5 py-2">Failed</span>
                            </td>
                            <td class="px-3 py-3 flex justify-center">
                                <button class="text-textLight dark:text-textDark flex justify-center gap-1"
                                    (click)="downloadInvoice(order.id, order.invNo)">
                                    <i class="fa-solid fa-file-lines text-2xl"></i>
                                </button>
                            </td>
                        </tr>
                    </ng-container>

                    <ng-template #noData>
                        <tr>
                            <td colspan="8" class="px-3 py-16 text-center">
                                <div class="flex flex-col items-center justify-center space-y-3">
                                    <i class="fa-solid fa-box-open text-5xl text-gray-400 dark:text-gray-500"></i>
                                    <p class="text-lg font-medium text-textLight dark:text-textDark">
                                        No orders available
                                    </p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400">
                                        There are no orders for the selected status
                                    </p>
                                </div>
                            </td>
                        </tr>
                    </ng-template>
                </tbody>
            </table>
        </div>
    </div>
</div>