<app-loading-spinner *ngIf="isLoading"></app-loading-spinner>

<div class="min-h-max py-8 px-8">
  <div class="flex flex-row justify-between items-center">
    <p class="text-xl font-bold dark:text-white text-[#030308]">
      {{ centerDetails.regCode }} {{ centerDetails.centerName }}
    </p>
    <div
      class="flex items-center rounded-full px-4 py-2 w-96 bg-[#F1F1F1] dark:bg-[#272F45]"
    >
      <input
        [(ngModel)]="searchText"
        (keyup.enter)="onSearchVarity()"
        (keyup.esc)="offSearchVarity()"
        type="text"
        placeholder="Search by Variety Name"
        class="bg-transparent outline-none w-full text-textLight dark:text-textDark"
      />
      <button
        (click)="onSearchVarity()"
        type="button"
        class="text-gray-500 hover:text-gray-700 focus:outline-none mr-2"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M21 21l-6-6m2-5a7 7 0 10-14 0 7 7 0 0014 0z"
          />
        </svg>
      </button>
      <button
        (click)="offSearchVarity()"
        type="button"
        class="text-gray-500 hover:text-gray-700 focus:outline-none"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          />
        </svg>
      </button>
    </div>
  </div>

  <div
    *ngIf="hasData"
    class="min-w-max mt-8 mr-5 border-gray-100 border-[2px] rounded-lg dark:border-[#202021]"
  >
    <table class="w-full divide-y divide-gray-200 dark:divide-[#4B555A] table-auto whitespace-nowrap ">
      <thead
        class="pl-5 font-normal text-textLight dark:text-textDark text-center border-gray-200 dark:border-[#4B555A]"
      >
        <tr>
          <th class="px-6 py-3 text-left text-textLight dark:text-textDark">
            ITEM ({{ cropCount < 10 ? "0" + cropCount : cropCount }})
          </th>
          <th class="px-6 py-3 text-left text-textLight dark:text-textDark">Crop</th>
          <th class="px-6 py-3 text-left text-textLight dark:text-textDark">Variety</th>
          <th class="px-6 py-3 text-left text-textLight dark:text-textDark">Status</th>
        </tr>
      </thead>
      <tbody class="bg-white dark:bg-[#061E2C] dark:border-[#1E293B]">
        <!-- <tr
                    *ngFor="let item of priceListArr | paginate : { itemsPerPage: itemsPerPage, currentPage: page, totalItems: totalItems }; let i = index"> -->
        <tr class="border-b border-gray-200 dark:border-[#4B555A]"
          *ngFor="
            let item of cropsArr
              | paginate
                : {
                    itemsPerPage: itemsPerPage,
                    currentPage: page,
                    totalItems: totalItems
                  };
            let i = index
          "
        >
          <td class="px-6 py-4 text-textLight dark:text-textDark">
            {{
              (page - 1) * itemsPerPage + i + 1 < 10
                ? "0" + ((page - 1) * itemsPerPage + i + 1)
                : (page - 1) * itemsPerPage + i + 1
            }}
          </td>
          <td class="px-6 py-4 text-gray-900 dark:text-[#C5C5C5]">
            {{ item.cropNameEnglish }}
          </td>
          <td class="px-6 py-4 text-gray-900 dark:text-[#C5C5C5]">
            {{ item.varietyNameEnglish }}
          </td>
          <td class="px-6 py-4 text-gray-900 dark:text-[#C5C5C5]">
            <label class="inline-flex items-center cursor-pointer">
              <input
                type="checkbox"
                class="sr-only peer"
                name="isAssign"
                [ngModel]="item.isAssign === 1"
                (click)="onAdd(item.isAssign, item.cropId)"
                (ngModelChange)="item.isAssign = $event ? 1 : 0"
                name="isAssign"
              />
              <div
                class="relative w-14 h-7 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:start-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600 dark:peer-checked:bg-blue-600"
              ></div>
            </label>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <div
    class="flex justify-end items-center my-5 mr-5 pt-3 dark:bg-[#262f45] text-right"
  >
    <pagination-controls
      (pageChange)="onPageChange($event)"
      [responsive]="true"
      [previousLabel]="'Previous'"
      [nextLabel]="'Next'"
      [screenReaderPaginationLabel]="'Pagination'"
      [screenReaderPageLabel]="'page'"
      [screenReaderCurrentLabel]="'Youre on page'"
    >
    </pagination-controls>
  </div>
</div>
