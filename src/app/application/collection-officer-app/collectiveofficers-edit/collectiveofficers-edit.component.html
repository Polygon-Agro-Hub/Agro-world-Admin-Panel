<div *ngIf="isLoading">
  <app-loading-spinner></app-loading-spinner>
</div>

<button
  onclick="window.location.href='/admin/steckholders/action/collective-officer'"
  (click)="navigatePath('/steckholders/action/collective-officer')"
  class="ml-5 text-textLight dark:text-textDark"
>
  <i class="fa-solid fa-arrow-left"></i>
  Back
</button>
<div class="h-[20px]"></div>
<div
  
  class="mx-auto p-6 bg-white dark:bg-tileBlack rounded-lg shadow-mg"
>
  
    <div *ngIf="selectedPage === 'pageOne'">
    <!-- <div> -->
      <h2 class="text-2xl mb-6 text-textLight dark:text-textDark">
        Add Personal Details
      </h2>
      <div>
        <div class="flex justify-center pt-3 pb-9">
          <div class="relative">
            <input
              type="file"
              id="imageUpload"
              accept="image/*"
              class="hidden"
              (change)="onFileSelected($event)"
            />

            <!-- Display default image if no file is selected -->
            <img
              *ngIf="!selectedImage && personalData.image"
              class="rounded-full w-60 h-60"
              [src]="personalData.image"
              alt="Profile Picture"
            />

            <img
              *ngIf="!personalData.image && !selectedImage"
              class="rounded-full w-60 h-60"
              [src]="'https://img.freepik.com/premium-vector/default-avatar-profile-icon-social-media-user-image-gray-avatar-icon-blank-profile-silhouette-vector-illustration_561158-3407.jpg?w=360'"
              alt="Profile Picture"
            />

            <!-- Display the selected image if available -->
            <img
              *ngIf="selectedImage"
              class="rounded-full w-60 h-60"
              [src]="selectedImage"
              alt="Profile Picture"
            />
            

            <span
              (click)="triggerFileInput($event)"
              class="absolute bottom-5 right-5 transform translate-x-1/4 translate-y-1/4 bg-white p-1 rounded-full cursor-pointer"
            >
              <img
                src="../../../assets/images/editIcon.png"
                alt="Edit Icon"
                class="w-16 h-16"
              />
            </span>
          </div>
        </div>


        

        <div class="h-[20px]"></div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">





          <div>
            
            <label for="enpType" class="block text-sm font-medium text-gray-700 dark:text-textDark">
              Staff Employee Type
            </label>
          
            <div class="flex items-center space-x-4 mt-3">
              <div class="flex items-center space-x-2">
                <input
                  class="w-5 h-5"
                  type="radio"
                  id="permanent"
                  name="enpType"
                  [value]="'Permanent'"
                  [(ngModel)]="empType"
                  (ngModelChange)="updateEmployeeType($event)"
                />
                <label
                  for="permanent"
                  class="block text-sm font-medium text-gray-700 dark:text-textDark"
                >
                  Permanent
                </label>
              </div>
              <div class="flex items-center space-x-2">
                <input
                  class="w-5 h-5"
                  type="radio"
                  id="temporary"
                  name="enpType"
                  [value]="'Temporary'"
                  [(ngModel)]="empType"
                  (ngModelChange)="updateEmployeeType($event)"
                />
                <label
                  for="temporary"
                  class="block text-sm font-medium text-gray-700 dark:text-textDark"
                >
                  Temporary
                </label>
              </div>
            </div>
          </div>
          
          
          
        
         


          





          <div>
            <label for="languages" class="block text-sm font-medium text-gray-700 dark:text-textDark">
              Preferred Languages
            </label>
          
            <div class="flex items-center space-x-4 mt-3">
              <div class="flex items-center space-x-2">
                <input
                  class="w-5 h-5"
                  type="checkbox"
                  id="sinhala"
                  name="languages"
                  value="Sinhala"
                  [checked]="selectedLanguages.includes('Sinhala')"
                  (change)="onCheckboxChange('Sinhala', $event)"
                />
                <label for="sinhala" class="text-gray-700 dark:text-textDark">Sinhala</label>
              </div>
              <div class="flex items-center space-x-2">
                <input
                  class="w-5 h-5"
                  type="checkbox"
                  id="english"
                  name="languages"
                  value="English"
                  [checked]="selectedLanguages.includes('English')"
                  (change)="onCheckboxChange('English', $event)"
                />
                <label for="english" class="text-gray-700 dark:text-textDark">English</label>
              </div>
              <div class="flex items-center space-x-2">
                <input
                  class="w-5 h-5"
                  type="checkbox"
                  id="tamil"
                  name="languages"
                  value="Tamil"
                  [checked]="selectedLanguages.includes('Tamil')"
                  (change)="onCheckboxChange('Tamil', $event)"
                />
                <label for="tamil" class="text-gray-700 dark:text-textDark">Tamil</label>
              </div>
            </div>
          </div>
          







          <div>
            <label
              for="centerId"
              class="block text-sm font-medium text-gray-700 dark:text-textDark"
            >
              Company Name
            </label>
            <select
              
              id="centerId"
              [(ngModel)]="personalData.companyId"
              name="centerId"
              class="form-control mt-1 block w-full p-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-100 dark:bg-gray-800 appearance-none focus:ring-indigo-500 focus:border-indigo-500"
            >
              <option
                *ngFor="let center of CompanyData"
                [value]="center.id"
                class="p-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-800"
              >
                {{ center.companyNameEnglish }}
              </option>
            </select>
          </div>


          <div>
            <label
              for="centerId"
              class="block text-sm font-medium text-gray-700 dark:text-textDark"
            >
              Collection Center Name
            </label>
            <select
              
              id="centerId"
              [(ngModel)]="personalData.centerId"
              name="centerId"
              class="form-control mt-1 block w-full p-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-100 dark:bg-gray-800 appearance-none focus:ring-indigo-500 focus:border-indigo-500"
            >
              <option
                *ngFor="let center of collectionCenterData"
                [value]="center.id"
                class="p-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-800"
              >
                {{ center.centerName }}
              </option>
            </select>
          </div>

          





          






          

          <div>
            <label
              for="jobRole"
              class="block text-sm font-medium text-gray-700 dark:text-textDark"
            >
              Job Role
            </label>
            <select
             
              id="jobRole"
              [(ngModel)]="personalData.jobRole"
              (change)="EpmloyeIdCreate()"
              name="jobRole"
              placeholder="select"
              class="form-control mt-1 block w-full p-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-100 dark:bg-gray-800 appearance-none focus:ring-indigo-500 focus:border-indigo-500"
            >
              <option
                disabled
                class="p-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-800"
              >
                -- select --
              </option>
              <option
              value="Collection Center Head"
              class="p-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-800"
            >
              Collection Center Head
            </option>
              <option
                selected
                value="Collection Center Manager"
                class="p-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-800"
              >
                Collection Center Manager
              </option>
              <option
                value="Collection Officer"
                class="p-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-800"
              >
                Collection Officer
              </option>
              <option
                value="Customer Officer"
                class="p-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-800"
              >
                Customer Officer
              </option>
            </select>
          </div>




          





          <div>
            <label
              class="block text-sm font-medium text-gray-700 dark:text-textDark"
              >EMP ID / User name</label
            >
            <div class="flex mt-1">
              <span
                class="inline-flex items-center px-3 py-3 text-sm text-gray-900 bg-gray-200 border border-e-0 border-gray-300 rounded-s-md dark:bg-gray-600 dark:text-gray-400 dark:border-gray-600"
              >
              <p *ngIf="personalData.jobRole === 'Collection Center Head'">
                CCH
              </p>
                <p *ngIf="personalData.jobRole === 'Collection Center Manager'">
                  CCM
                </p>
                <p *ngIf="personalData.jobRole === 'Collection Officer'">COO</p>
                <p *ngIf="personalData.jobRole === 'Customer Officer'">CUO</p>
              </span>
              <input
                type="text"
                [value]="lastID"
                name="empId"
               
                class="rounded-none rounded-e-lg bg-gray-50 border border-gray-300 text-gray-900 focus:ring-blue-500 focus:border-blue-500 block flex-1 min-w-0 w-full text-sm pl-4 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                disabled
              />
            </div>
          </div>




          <div *ngIf="personalData.jobRole === 'Collection Officer'">
            <label
              for="centerId"
              class="block text-sm font-medium text-gray-700 dark:text-textDark"
            >
              Manager Name
            </label>
            <select
            
              id="centerId"
              [(ngModel)]="personalData.irmId"
              name="centerId"
              class="form-control mt-1 block w-full p-2 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-100 dark:bg-gray-800 appearance-none focus:ring-indigo-500 focus:border-indigo-500"
            >
              <option
                *ngFor="let center of collectionManagerData"
                [value]="center.id"
                class="p-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-800"
              >
                {{ center.firstNameEnglish }}
              </option>
            </select>
          </div>




          <div>
            <label
              for="firstNameEnglish"
              class="block text-sm font-medium text-gray-700 dark:text-textDark"
              >First Name (in English)</label
            >
            <input
              
              id="firstNameEnglish"
              [(ngModel)]="personalData.firstNameEnglish"
              name="firstNameEnglish"
              class="form-control mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
            />
          </div>

          <div>
            <label
              for="variety"
              class="block text-sm font-medium text-gray-700 dark:text-textDark"
              >Last Name (in English)</label
            >
            <input
            
              id="lastName"
              name="lastName"
              [(ngModel)]="personalData.lastNameEnglish"
              class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
            />
          </div>

          <div>
            <label
              for="crop"
              class="block text-sm font-medium text-gray-700 dark:text-textDark"
              >First Name (in Sinhala)</label
            >
            <input
             
              id="firstName"
              name="firstName"
              [(ngModel)]="personalData.firstNameSinhala"
              class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
            />
          </div>

          <div>
            <label
              for="variety"
              class="block text-sm font-medium text-gray-700 dark:text-textDark"
              >Last Name (in Sinhala)</label
            >
            <input
             
              id="lastName"
              name="lastName"
              [(ngModel)]="personalData.lastNameSinhala"
              class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
            />
          </div>

          <div>
            <label
              for="crop"
              class="block text-sm font-medium text-gray-700 dark:text-textDark"
              >First Name (in Tamil)</label
            >
            <input
              
              id="firstName"
              name="firstName"
              [(ngModel)]="personalData.firstNameTamil"
              class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
            />
          </div>

          <div>
            <label
              for="variety"
              class="block text-sm font-medium text-gray-700 dark:text-textDark"
              >Last Name (in Tamil)</label
            >
            <input
              
              id="lastName"
              name="lastName"
              [(ngModel)]="personalData.lastNameTamil"
              class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
            />
          </div>

          <div>
            <label
              for="phoneNumber01"
              class="block text-sm font-medium text-gray-700 dark:text-textDark"
            >
              Phone Number - 1
            </label>
            <div class="mt-1 flex">
              <select
                id="phoneNumber01Code"
                name="phoneNumber01Code"
                
                [(ngModel)]="personalData.phoneCode01"
                class="block p-2 border border-gray-300 rounded-l-md bg-gray-50 mr-5 text-textLight dark:text-textDark dark:bg-tileBlack"
              >
                <option value="+94">+94 (LK)</option>
                <option value="+1">+1 (US)</option>
                <option value="+44">+44 (UK)</option>
                <option value="+91">+91 (India)</option>
              </select>
              <input
                
                id="phoneNumber01"
                name="phoneNumber01"
                type="number"
                [(ngModel)]="personalData.phoneNumber01"
                class="block w-full p-2 border border-gray-300 rounded-r-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
                placeholder="Enter your phone number"
              />
            </div>
          </div>

          <div>
            <label
              for="phoNumTwo"
              class="block text-sm font-medium text-gray-700 dark:text-textDark"
            >
              Phone Number - 2
            </label>
            <div class="mt-1 flex">
              <select
                id="phoneNumber02Code"
                name="phoneNumber02Code"
              
                [(ngModel)]="personalData.phoneCode02"
                class="block p-2 border border-gray-300 rounded-l-md bg-gray-50 mr-5 text-textLight dark:text-textDark dark:bg-tileBlack"
              >
                <option value="+94">+94 (LK)</option>
                <option value="+1">+1 (US)</option>
                <option value="+44">+44 (UK)</option>
                <option value="+91">+91 (India)</option>
              </select>
              <input
                
                id="phoneNumber02"
                name="phoneNumber02"
                type="number"
                [(ngModel)]="personalData.phoneNumber02"
                class="block w-full p-2 border border-gray-300 rounded-r-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
                placeholder="Enter your phone number"
              />
            </div>
          </div>

          <div>
            <label
              for="nic"
              class="block text-sm font-medium text-gray-700 dark:text-textDark"
              >NIC Number</label
            >
            <input
           
              id="nic"
              name="nic"
              [(ngModel)]="personalData.nic"
              class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
            />
          </div>

          <div>
            <label
              for="email"
              class="block text-sm font-medium text-gray-700 dark:text-textDark"
              >Email</label
            >
            <input
              
              type="email"
              id="email"
              name="nic"
              [(ngModel)]="personalData.email"
              class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
            />
          </div>






          
          
          







         
        </div>

        <div class="flex justify-end m-10">
          <button
            (click)="onCancel()"
            type="button"
            class="px-4 py-2 bg-gray-300 text-gray-700 rounded-md mr-2"
          >
            Cancel
          </button>
          <button
            (click)="nextFormCreate('pageTwo')"
            type="button"
            class="px-4 py-2 bg-[#3980C0] text-white rounded-md"
          >
            Next
          </button>
        </div>
      </div>
    </div>

    <div *ngIf="selectedPage === 'pageTwo'">
    <!-- <div> -->
      <h2 class="text-2xl mb-6 text-textLight dark:text-textDark">
        Residential Details
      </h2>
      <div>
<div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">

  <div class="pb-6">
    <label
      for="house"
      class="block text-sm font-medium text-gray-700 dark:text-textDark"
      >House / Plot Number</label
    >
    <input
      
      id="houseNumber"
      name="houseNumber"
      [(ngModel)]="personalData.houseNumber"
      class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
    />
  </div>

  <div class="pb-6">
    <label
      for="street"
      class="block text-sm font-medium text-gray-700 dark:text-textDark"
      >Street Name</label
    >
    <input
     
      id="streetName"
      name="streetName"
      [(ngModel)]="personalData.streetName"
      class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
    />
  </div>



  <div class="pb-6">
    <label
      for="city"
      class="block text-sm font-medium text-gray-700 dark:text-textDark"
      >City</label
    >
    <input
      
      id="city"
      name="city"
      [(ngModel)]="personalData.city"
      class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
    />
  </div>

  <div class="pb-6">
    <label
      for="district"
      class="block text-sm font-medium text-gray-700 dark:text-textDark"
    >
      District
    </label>
    <select
    
      id="district"
      name="district"
      [(ngModel)]="personalData.district"
      (change)="updateProvince($event)"
      class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
    >
      <option value="" disabled selected>Select a district</option>
      <option
        *ngFor="let district of districts"
        [value]="district.name"
      >
        {{ district.name }}
      </option>
    </select>
  </div>

  <div class="pb-6">
    <label
      for="province"
      class="block text-sm font-medium text-gray-700 dark:text-textDark"
    >
      Province
    </label>
    <input
      
      id="province"
      name="province"
      [(ngModel)]="personalData.province"
      class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
      readonly
    />
  </div>

  <div class="pb-6">
    <label
      for="country"
      class="block text-sm font-medium text-gray-700 dark:text-textDark"
      >Country</label
    >
    <input
      
      id="country"
      name="country"
      [(ngModel)]="personalData.country"
      class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
    />
  </div>
</div>
       

        

        
      </div>
      <div *ngIf="personalData.companyId == 1">
        <h2 class="text-2xl mt-10 mb-6 text-textLight dark:text-textDark">
          Add Bank Details
        </h2>
        <div class="pb-6">
          <label
            for="accHolderName"
            class="block text-sm font-medium text-gray-700 dark:text-textDark"
            >Account Holderâ€™s Name</label
          >
          <input
            id="accHolderName"
            name="accHolderName"
            
            [(ngModel)]="personalData.accHolderName"
            class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
          />
        </div>

        <div class="pb-6">
          <label
            for="accNumber"
            class="block text-sm font-medium text-gray-700 dark:text-textDark"
            >Account Number</label
          >
          <input
            id="accNumber"
            name="accNumber"
            
            [(ngModel)]="personalData.accNumber"
            class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
          />
        </div>

        <!-- <div class="pb-6">
          <label
            for="bankName"
            class="block text-sm font-medium text-gray-700 dark:text-textDark"
            >Bank Name</label
          >
          <input
            id="bankName"
            name="bankName"
           
            [(ngModel)]="personalData.bankName"
            class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
          />
        </div> -->

        <div class="pb-6">
          <label
            for="bankDropdown"
            class="block text-sm font-medium text-gray-700 dark:text-textDark"
            >Bank Name</label
          >
          <select 
            id="bankDropdown" 
            name="bankDropdown"
            [(ngModel)]="selectedBankId"
            (change)="onBankChange()"
            class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack">
            <option [ngValue]="null" disabled>Select a bank</option>
            <option *ngFor="let bank of banks" [ngValue]="bank.ID">{{ bank.name }}</option>
          </select>
        </div>

        <!-- <div class="pb-6">
          <label
            for="branchName"
            class="block text-sm font-medium text-gray-700 dark:text-textDark"
            >Branch Name</label
          >
          <input
            id="branchName"
            name="branchName"
           
            [(ngModel)]="personalData.branchName"
            class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
          />
        </div> -->
        <div class="pb-6">
          <label
            for="branchDropdown"
            class="block text-sm font-medium text-gray-700 dark:text-textDark"
            >Branch Name</label
          >
          <select 
            id="branchDropdown" 
            name="branchDropdown"
            [(ngModel)]="selectedBranchId"
            (change)="onBranchChange()"
            [disabled]="!selectedBankId"
            class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack">
            <option [ngValue]="null" disabled>Select a branch</option>
            <option *ngFor="let branch of branches" [ngValue]="branch.ID">{{ branch.name }}</option>
          </select>
        </div>
      </div>

      <div class="flex justify-end m-10">
        <button
          (click)="nextForm('pageOne')"
          type="button"
          class="px-4 py-2 bg-gray-300 text-gray-700 rounded-md mr-2"
        >
          Back
        </button>
        <button
          type="submit"
          (click)="onSubmit()"
          [disabled]="!personalData.accNumber || !personalData.accHolderName"
          class="px-4 py-2 bg-[#3980C0] text-white rounded-md"
        >
          Submit
        </button>
      </div>
    </div>
</div>



















































