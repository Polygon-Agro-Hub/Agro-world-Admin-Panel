<div *ngIf="isLoading">
    <app-loading-spinner></app-loading-spinner>
  </div>
  
  <button 
  onclick="history.back()" class="ml-5 text-textLight dark:text-textDark">
    <i class="fa-solid fa-arrow-left"></i>
    Back
  </button>
  <div class="h-[20px]"></div>
  <div class="mx-auto p-6 bg-white dark:bg-tileBlack rounded-lg shadow-mg">
  
    <div>
      <!-- <div> -->
      <h2 class="text-2xl mb-6 text-textLight dark:text-textDark">
        Edit Center Head Details
      </h2>
      <div>
        <div class="flex justify-center pt-3 pb-9">
          <div class="relative">
            <input type="file" id="imageUpload" accept="image/*" class="hidden" (change)="onFileSelected($event)" />
  
            <!-- Display default image if no file is selected -->
            <img *ngIf="!selectedImage && personalData.image" class="rounded-full w-60 h-60" [src]="personalData.image"
              alt="Profile Picture" />
  
            <img *ngIf="!personalData.image && !selectedImage" class="rounded-full w-60 h-60"
              [src]="'https://img.freepik.com/premium-vector/default-avatar-profile-icon-social-media-user-image-gray-avatar-icon-blank-profile-silhouette-vector-illustration_561158-3407.jpg?w=360'"
              alt="Profile Picture" />
  
            <!-- Display the selected image if available -->
            <img *ngIf="selectedImage" class="rounded-full w-60 h-60" [src]="selectedImage" alt="Profile Picture" />
  
  
            <span (click)="triggerFileInput($event)"
              class="absolute bottom-5 right-5 transform translate-x-1/4 translate-y-1/4 bg-white p-1 rounded-full cursor-pointer">
              <img src="../../../assets/images/editIcon.png" alt="Edit Icon" class="w-16 h-16" />
            </span>
          </div>
        </div>
  
        <div class="h-[20px]"></div>
  
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">

          <div>
            <label for="firstName" class="block text-sm font-medium text-gray-700 dark:text-textDark">First Name</label>
            <input id="firstName" [(ngModel)]="personalData.firstName" name="firstName"
              class="form-control mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
              #firstNameInput="ngModel" required />
            <div *ngIf="firstNameInput.touched && !personalData.firstName"
              class="text-red-500 text-sm mt-1">
              <div>First Name is required</div>
            </div>
          </div>
  
          <div>
            <label for="variety" class="block text-sm font-medium text-gray-700 dark:text-textDark">Last Name (in
              English)</label>
            <input id="lastName" name="lastName" [(ngModel)]="personalData.lastName"
              class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
              #lastNameInput="ngModel" required />
            <div *ngIf="lastNameInput.touched && !personalData.lastName" class="text-red-500 text-sm mt-1">
              <div>Last Name is required</div>
            </div>
          </div>
          <div>
            <label for="enpType" class="block text-sm font-medium text-gray-700 dark:text-textDark">
              Staff Employee Type
            </label>
  
            <div class="flex items-center space-x-4 mt-3">
              <div class="flex items-center space-x-2">
                <input class="w-5 h-5" type="radio" id="permanent" name="empType" [value]="'Permanent'"
                  [(ngModel)]="empType" #empTypeInput="ngModel" (ngModelChange)="updateEmployeeType($event)" required />
                <label for="permanent" class="block text-sm font-medium text-gray-700 dark:text-textDark">
                  Permanent
                </label>
              </div>
              <div class="flex items-center space-x-2">
                <input class="w-5 h-5" type="radio" id="temporary" name="empType" [value]="'Temporary'"
                  [(ngModel)]="empType" (ngModelChange)="updateEmployeeType($event)" required />
                <label for="temporary" class="block text-sm font-medium text-gray-700 dark:text-textDark">
                  Temporary
                </label>
              </div>
            </div>
  
            
            <div *ngIf="empTypeInput.touched && !empType" class="text-red-500 text-sm mt-1">
              <div>Employee Type is required</div>
            </div>
  
        </div>

          

        <div class='mb-4 w-full'>
            <div>
              <label
                class="block text-sm font-medium text-gray-700 dark:text-textDark"
                >EMP ID / User name</label
              >
              <div class="flex mt-1">
                <span
                  class="inline-flex items-center px-3 py-3 text-sm text-gray-900 bg-gray-200 border border-e-0 border-gray-300 rounded-s-md dark:bg-gray-600 dark:text-gray-400 dark:border-gray-600"
                >
                  <p >
                    SA
                  </p>
                  
                </span>
                <input
                  type="text"
                  [value]="lastID"
                  name="empId"
                  class="rounded-none rounded-e-lg bg-gray-50 border border-gray-300 text-gray-900 focus:ring-blue-500 focus:border-blue-500 block flex-1 min-w-0 w-full text-sm pl-4 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                  disabled
                />
              </div>
            </div>
          </div>
  
          
  
          <div>
            <label for="phoneNumber1" class="block text-sm font-medium text-gray-700 dark:text-textDark">
              Phone Number - 1
            </label>
            <div class="mt-1 flex">
              <select id="phoneNumber1Code" name="phoneNumber1Code" [(ngModel)]="personalData.phoneCode1"
                class="block p-2 border border-gray-300 rounded-l-md bg-gray-50 mr-5 text-textLight dark:text-textDark dark:bg-tileBlack">
                <option value="+94">+94 (LK)</option>
                <option value="+1">+1 (US)</option>
                <option value="+44">+44 (UK)</option>
                <option value="+91">+91 (India)</option>
              </select>
              <input id="phoneNumber1" name="phoneNumber1" type="text" [(ngModel)]="personalData.phoneNumber1"
                class="block w-full p-2 border border-gray-300 rounded-r-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
                placeholder="7XXXXXXXX" #phoneNumber1Input="ngModel" required minlength="9" maxlength="9"
                pattern="^[0-9]{9}$" />
            </div>
  
            <!-- Required Validation -->
            <div *ngIf="phoneNumber1Input.touched && !personalData.phoneNumber1" class="text-red-500 text-sm mt-1">
              <div>Phone Number - 1 is required</div>
            </div>
  
            <!-- Length Validation -->
            <div *ngIf="phoneNumber1Input.touched && phoneNumber1Input.errors?.['minlength']"
              class="text-red-500 text-sm mt-1">
              <div>Phone Number must be exactly 9 digits</div>
            </div>
  
            <div *ngIf="phoneNumber1Input.touched && phoneNumber1Input.errors?.['maxlength']"
              class="text-red-500 text-sm mt-1">
              <div>Phone Number must be exactly 9 digits</div>
            </div>
  
            <!-- Pattern Validation (Ensuring Only Numbers) -->
            <div *ngIf="phoneNumber1Input.touched && phoneNumber1Input.errors?.['pattern']"
              class="text-red-500 text-sm mt-1">
              <div>Phone Number can only contain numbers</div>
            </div>
          </div>
  
  
          <div>
            <label for="phoNumTwo" class="block text-sm font-medium text-gray-700 dark:text-textDark">
              Phone Number - 2
            </label>
            <div class="mt-1 flex">
              <select id="phoneNumber02Code" name="phoneNumber02Code" [(ngModel)]="personalData.phoneCode2"
                class="block p-2 border border-gray-300 rounded-l-md bg-gray-50 mr-5 text-textLight dark:text-textDark dark:bg-tileBlack">
                <option value="+94">+94 (LK)</option>
                <option value="+1">+1 (US)</option>
                <option value="+44">+44 (UK)</option>
                <option value="+91">+91 (India)</option>
              </select>
              <input id="phoneNumber2" name="phoneNumber2" type="number" [(ngModel)]="personalData.phoneNumber2"
                class="block w-full p-2 border border-gray-300 rounded-r-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
                placeholder="Enter your phone number" #phoneNumber2Input="ngModel" minlength="9" maxlength="9"
                pattern="^[0-9]{9}$" />
            </div>
            <div *ngIf="phoneNumber2Input.touched && phoneNumber2Input.errors?.['maxlength']"
              class="text-red-500 text-sm mt-1">
              <div>Phone Number must be exactly 9 digits</div>
            </div>
  
            <!-- Pattern Validation (Ensuring Only Numbers) -->
            <div *ngIf="phoneNumber2Input.touched && phoneNumber2Input.errors?.['pattern']"
              class="text-red-500 text-sm mt-1">
              <div>Phone Number can only contain numbers</div>
            </div>
          </div>
  
          <div>
            <label for="nic" class="block text-sm font-medium text-gray-700 dark:text-textDark">NIC Number</label>
            <input id="nic" name="nic" [(ngModel)]="personalData.nic"
              class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
              #nicInput="ngModel" required pattern="^(\d{9}[VX]|[0-9]{12})$" />
  
            <!-- Required Validation -->
            <div *ngIf="nicInput.touched && !personalData.nic" class="text-red-500 text-sm mt-1">
              <div>NIC Number is required</div>
            </div>
  
            <!-- Pattern Validation -->
            <div *ngIf="nicInput.touched && nicInput.errors?.['pattern']" class="text-red-500 text-sm mt-1">
              <div>NIC must be in the format of 9 digits</div>
            </div>
          </div>
  
  
          <div>
            <label for="email" class="block text-sm font-medium text-gray-700 dark:text-textDark">Email</label>
            <input type="email" id="email" name="email" [(ngModel)]="personalData.email"
              class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
              #emailInput="ngModel" required email />
  
            <div *ngIf="emailInput.touched && !personalData.email" class="text-red-500 text-sm mt-1">
              <div>Email is required</div>
            </div>
  
            <div *ngIf="emailInput.touched && emailInput.errors?.['email']" class="text-red-500 text-sm mt-1">
              <div>Please enter a valid email address</div>
            </div>
          </div>
        </div>
  
      </div>
    </div>

    <div>
        <!-- <div> -->
        <h2 class="text-2xl mb-6 text-textLight dark:text-textDark">
          Residential Details
        </h2>
        <div>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
    
            <div class="pb-6">
              <label for="house" class="block text-sm font-medium text-gray-700 dark:text-textDark">House / Plot
                Number</label>
              <input id="houseNumber" name="houseNumber" [(ngModel)]="personalData.houseNumber"
                class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack" 
                #houseNumberInput="ngModel" required />
              <div *ngIf="houseNumberInput.touched && !personalData.houseNumber" class="text-red-500 text-sm mt-1">
                <div>House number is required</div>
              </div>
    
            </div>
    
            <div class="pb-6">
              <label for="street" class="block text-sm font-medium text-gray-700 dark:text-textDark">Street Name</label>
              <input id="streetName" name="streetName" [(ngModel)]="personalData.streetName"
                class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack" 
                #streetNameInput="ngModel" required />
                <div *ngIf="streetNameInput.touched && !personalData.streetName" class="text-red-500 text-sm mt-1">
                  <div>Street Name is required</div>
                </div>
            </div>
    
    
    
            <div class="pb-6">
              <label for="city" class="block text-sm font-medium text-gray-700 dark:text-textDark">City</label>
              <input id="city" name="city" [(ngModel)]="personalData.city"
                class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack" 
                #cityInput="ngModel" required />
                <div *ngIf="cityInput.touched && !personalData.city" class="text-red-500 text-sm mt-1">
                  <div>City is required</div>
                </div>
            </div>
    
            <div class="pb-6">
              <label for="district" class="block text-sm font-medium text-gray-700 dark:text-textDark">
                District
              </label>
              <select id="district" name="district" [(ngModel)]="personalData.district" (change)="updateProvince($event)"
                class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"  #districtInput="ngModel" required>
                <option value="" disabled selected>Select a district</option>
                <option *ngFor="let district of districts" [value]="district.name">
                  {{ district.name }}
                </option>
              </select>
              <div *ngIf="districtInput.touched && !personalData.district" class="text-red-500 text-sm mt-1">
                <div>DistrictInput is required</div>
              </div>
            </div>
    
            <div class="pb-6">
              <label for="province" class="block text-sm font-medium text-gray-700 dark:text-textDark" >
                Province
              </label>
              <input id="province" name="province" [(ngModel)]="personalData.province"
                class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
                readonly />
            </div>
    
            <div class="pb-6">
              <label for="country" class="block text-sm font-medium text-gray-700 dark:text-textDark">Country</label>
              <input id="country" name="country" [(ngModel)]="personalData.country"
                class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack" readonly/>
            </div>
          </div>
    
    
    
    
    
        </div>
        <div>
          <h2 class="text-2xl mt-10 mb-6 text-textLight dark:text-textDark">
            Add Bank Details
          </h2>
          <div class="pb-6">
            <label for="accHolderName" class="block text-sm font-medium text-gray-700 dark:text-textDark">Account Holder’s
              Name</label>
            <input id="accHolderName" name="accHolderName" [(ngModel)]="personalData.accHolderName"
              class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack" 
              #accHolderNameInput="ngModel" required />
              <div *ngIf="accHolderNameInput.touched && !personalData.accHolderName" class="text-red-500 text-sm mt-1">
                <div>Account Holder's name is required</div>
              </div>
          </div>
    
          <div class="pb-6">
            <label for="accNumber" class="block text-sm font-medium text-gray-700 dark:text-textDark">Account Number</label>
            <input id="accNumber" name="accNumber" [(ngModel)]="personalData.accNumber"
              class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack" 
              #accNumberInput="ngModel" required />
              <div *ngIf="accNumberInput.touched && !personalData.accNumber" class="text-red-500 text-sm mt-1">
                <div>Account Number is required</div>
              </div>
          </div>

          <div class="pb-6">
            <label for="confirmAccNumber" class="block text-sm font-medium text-gray-700 dark:text-textDark">
              Confirm Account Number
            </label>
            <input
              id="confirmAccNumber"
              name="confirmAccNumber"
              [(ngModel)]="confirmAccNumber"
              (ngModelChange)="validateConfirmAccNumber()"
              class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack"
            />
            
            
            <span *ngIf="confirmAccountNumberRequired" class="text-red-600 text-sm">
              Confirm Account Number is required.
            </span>
          
           
            <span *ngIf="confirmAccountNumberError && !confirmAccountNumberRequired" class="text-red-600 text-sm">
              Account Numbers do not match.
            </span>
          </div>
    
          
    
          <div class="pb-6">
            <label for="bankDropdown" class="block text-sm font-medium text-gray-700 dark:text-textDark">Bank Name</label>
            <select id="bankDropdown" name="bankDropdown" [(ngModel)]="selectedBankId" (change)="onBankChange()"
              class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack">
              <option [ngValue]="null" disabled>Select a bank</option>
              <option *ngFor="let bank of banks" [ngValue]="bank.ID">{{ bank.name }}</option>
            </select>
          </div>
    
          
          <div class="pb-6">
            <label for="branchDropdown" class="block text-sm font-medium text-gray-700 dark:text-textDark">Branch
              Name</label>
            <select id="branchDropdown" name="branchDropdown" [(ngModel)]="selectedBranchId" (change)="onBranchChange()"
              [disabled]="!selectedBankId"
              class="mt-1 block w-full p-2 border border-gray-300 rounded-md text-textLight dark:text-textDark bg-tileLight dark:bg-tileBlack">
              <option [ngValue]="null" disabled>Select a branch</option>
              <option *ngFor="let branch of branches" [ngValue]="branch.ID">{{ branch.name }}</option>
            </select>
          </div>
        </div>
    
        <div class="flex justify-end m-10">
          <button onclick="history.back()" type="button" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-md mr-2">
            Back
          </button>
          <button type="submit" (click)="onSubmit()" [disabled]="!personalData.accNumber || !personalData.accHolderName"
            class="px-4 py-2 bg-[#3980C0] text-white rounded-md">
            Submit
          </button>
        </div>
      </div>
     
  </div>
