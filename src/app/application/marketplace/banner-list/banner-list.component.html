<app-loading-spinner *ngIf="isLoading"></app-loading-spinner>

<button class="mb-5 text-textLight dark:text-textDark" (click)="back()">
  <i class="fa-solid fa-arrow-left"></i>
  Back
</button>

<div
  class="fixed-width-container overflow-x-auto scrollbar-thin scrollbar-thumb-[#8AC440] scrollbar-track-transparent scrollbar-thumb-rounded-full"
>
  <div
    class="pt-5 pr-12 pl-12 pb-5 min-w-[1200px] bg-white dark:bg-tileBlack shadow-lg rounded-lg"
  >
    <div class="flex space-x-4 pb-5 border-b border-gray-300">
      <button
        (click)="toogleRetail(true)"
        [ngClass]="
          isRetail
            ? 'border border-[#415CFF] text-[#415CFF]'
            : 'border border-gray-300 text-textLight dark:text-textDark'
        "
        class="h-10 w-64 flex items-center justify-center rounded-xl gap-2"
      >
        <i *ngIf="isRetail" class="fa fa-check"></i>
        Retail Web Slider
      </button>

      <button
        (click)="toogleRetail(false)"
        [ngClass]="
          !isRetail
            ? 'border border-[#415CFF] text-[#415CFF]'
            : 'border border-gray-300 text-textLight dark:text-textDark'
        "
        class="h-10 w-64 flex items-center justify-center rounded-xl gap-2"
      >
        <i *ngIf="!isRetail" class="fa fa-check"></i>
        Wholesale Web Slider
      </button>
    </div>

    <div class="h-5"></div>

    <div *ngIf="isRetail">
      <button
        class="bg-[#3980C0] text-white font-medium py-2 px-5 rounded text-lg flex mb-5 items-center"
        (click)="addBannerRetail()"
      >
        <svg
          class="w-5 h-5 mr-3"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M4 12H20M12 4V20"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
        Add New
      </button>

      <div
        class="mx-auto p-6 bg-tileLight dark:bg-tileBlack rounded-lg shadow-md"
      >
        <div
          cdkDropList
          class="w-full space-y-3"
          (cdkDropListDropped)="drop($event)"
        >
          @for (feedback of feebackList; track feedback.id) {
          <div
            class="flex items-center gap-4 bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm cursor-move hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200"
            cdkDrag
          >
            <!-- Order Number -->
            <div
              class="min-w-[2rem] text-gray-600 dark:text-gray-400 font-medium"
            >
              {{ feedback.indexId.toString().padStart(2, "0") }}
            </div>

            <!-- Color Square -->
            <!-- <div class="w-8 h-8 rounded-md" [style.backgroundColor]="getColorByOrderNumber(feedback.indexId)"></div> -->
            <img
              *ngIf="feedback.image != null"
              class="profile-pic"
              [src]="feedback.image"
            />

            <!-- Feedback Text -->
            <div
              class="flex-grow text-gray-800 dark:text-gray-200 border border-gray-300 dark:border-gray-600 p-5 rounded-md"
            >
              {{ feedback.details }}
            </div>

            <!-- Delete Button -->
            <button
              (click)="deletebannerRetail(feedback.id)"
              class="text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 transition-colors duration-200 p-2"
            >
              <i class="fa-solid fa-trash"></i>
            </button>

            <!-- Drag Preview Placeholder -->
            <div
              *cdkDragPlaceholder
              class="bg-gray-100 dark:bg-gray-700 rounded-lg opacity-50 h-[60px]"
            ></div>
          </div>
          }
        </div>
      </div>
    </div>

    <div *ngIf="!isRetail">
      <button
        class="bg-[#3980C0] text-white font-medium py-2 px-5 rounded text-lg flex mb-5 items-center"
        (click)="addBannerWholesale()"
      >
        <svg
          class="w-5 h-5 mr-3"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M4 12H20M12 4V20"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
        Add New
      </button>

      <div
        class="mx-auto p-6 bg-tileLight dark:bg-tileBlack rounded-lg shadow-md"
      >
        <div
          cdkDropList
          class="w-full space-y-3"
          (cdkDropListDropped)="dropWhole($event)"
        >
          @for (feedback of feebackListWhole; track feedback.id) {
          <div
            class="flex items-center gap-4 bg-white dark:bg-gray-800 p-4 rounded-lg shadow-sm cursor-move hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200"
            cdkDrag
          >
            <!-- Order Number -->
            <div
              class="min-w-[2rem] text-gray-600 dark:text-gray-400 font-medium"
            >
              {{ feedback.indexId.toString().padStart(2, "0") }}
            </div>

            <!-- Color Square -->
            <!-- <div class="w-8 h-8 rounded-md" [style.backgroundColor]="getColorByOrderNumber(feedback.indexId)"></div> -->
            <img
              *ngIf="feedback.image != null"
              class="profile-pic"
              [src]="feedback.image"
            />

            <!-- Feedback Text -->
            <div
              class="flex-grow text-gray-800 dark:text-gray-200 border border-gray-300 dark:border-gray-600 p-5 rounded-md"
            >
              {{ feedback.details }}
            </div>

            <!-- Delete Button -->
            <button
              (click)="deletebannerRetail(feedback.id)"
              class="text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 transition-colors duration-200 p-2"
            >
              <i class="fa-solid fa-trash"></i>
            </button>

            <!-- Drag Preview Placeholder -->
            <div
              *cdkDragPlaceholder
              class="bg-gray-100 dark:bg-gray-700 rounded-lg opacity-50 h-[60px]"
            ></div>
          </div>
          }
        </div>
      </div>
    </div>
  </div>
</div>

<div
  *ngIf="ViewRetailAddBanner"
  class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"
>
  <!-- Added overflow-y-auto to the outer container to handle cases where the modal might be taller than screen -->
  <div
    class="max-w-2xl w-full mx-4 p-6 bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-y-auto"
    style="max-height: 90vh"
  >
    <!-- Changed from max-h-[120vh] to 90vh for better responsiveness -->

    <div
      class="space-y-6 overflow-y-auto"
      style="max-height: calc(90vh - 48px)"
    >
      <!-- 48px accounts for padding (24px top + 24px bottom) -->

      <h2 class="text-xl font-semibold text-center">
        Upload Retail Web Banner
      </h2>

      <div>
        <label class="block text-sm font-medium text-gray-700">Index No</label>
        <input
          type="text"
          placeholder="--auto fill--"
          [(ngModel)]="indexRetail"
          disabled
          class="mt-1 pl-3 block h-10 w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm bg-gray-100"
        />
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700">
          Banner Name here
          <span class="text-xs text-gray-500">( Maximum 50 characters )</span>
        </label>
        <input
          type="text"
          placeholder="--Enter Name here--"
          maxlength="50"
          [(ngModel)]="bannerName"
          class="mt-1 pl-3 h-10 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"
        />
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700">
          Image
          <span class="text-xs text-gray-500"
            >( Suggested Dimension : 1200 × 451 px )</span
          >
        </label>

        <div
          class="mt-2 flex items-center justify-center border-2 border-dashed border-blue-400 rounded-md p-6 text-center text-blue-500 cursor-pointer bg-blue-50 hover:bg-blue-100 relative"
          (drop)="onDropRetail($event)"
          (dragover)="onDragOverRetail($event)"
          (dragleave)="onDragLeaveRetail($event)"
          [class.bg-blue-100]="isDragOverReatil"
        >
          <input
            type="file"
            accept="image/png, image/jpeg"
            class="hidden"
            id="fileUpload"
            (change)="onFileSelectedRetail($event)"
          />
          <label
            for="fileUpload"
            class="cursor-pointer w-full h-full flex flex-col items-center justify-center"
          >
            <ng-container *ngIf="selectedRetailImageUrl; else placeholder">
              <div class="flex flex-col items-center">
                <img
                  [src]="selectedRetailImageUrl"
                  alt="Preview"
                  class="max-h-48 rounded-md object-contain"
                />
                <p
                  class="mt-2 text-sm text-gray-600 dark:text-gray-300 truncate max-w-xs"
                >
                  {{ selectedFile?.name }}
                </p>
              </div>
            </ng-container>
            <ng-template #placeholder>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-10 w-10 mb-2"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M7 16V4m0 0L4 7m3-3l3 3M17 16v-6m0 0l-3 3m3-3l3 3M4 20h16"
                />
              </svg>
              <p class="text-sm">
                <span class="font-medium"
                  >Select a JPG / PNG file to upload</span
                >
                <br />
                or drag and drop it here
              </p>
            </ng-template>
          </label>
        </div>
      </div>

      <div
        class="flex justify-end space-x-2 pt-4 sticky bottom-0 bg-white dark:bg-gray-800 pb-2"
      >
        <!-- Made buttons sticky at the bottom -->
        <button
          class="px-4 py-2 rounded-md text-sm font-medium bg-gray-300 text-gray-800 hover:bg-gray-400"
          (click)="cancelUploadRetail()"
        >
          Cancel
        </button>
        <button
          class="px-4 py-2 rounded-md text-sm font-medium bg-indigo-600 text-white hover:bg-indigo-700"
          (click)="uploadBanner()"
        >
          Upload
        </button>
      </div>
    </div>
  </div>
</div>


      <div
      *ngIf="ViewWholesaleAddBanner"
      class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"
    >
      <!-- Added overflow-y-auto to the outer container to handle cases where the modal might be taller than screen -->
      <div
        class="max-w-2xl w-full mx-4 p-6 bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-y-auto"
        style="max-height: 90vh"
      >
        <!-- Changed from max-h-[120vh] to 90vh for better responsiveness -->
    
        <div
          class="space-y-6 overflow-y-auto"
          style="max-height: calc(90vh - 48px)"
        >
          <!-- 48px accounts for padding (24px top + 24px bottom) -->
    
          <h2 class="text-xl font-semibold text-center">
            Upload Wholesale Web Banner
          </h2>
    
          <div>
            <label class="block text-sm font-medium text-gray-700">Index No</label>
            <input
              type="text"
              placeholder="--auto fill--"
              [(ngModel)]="indexWholesale"
              disabled
              class="mt-1 pl-3 block h-10 w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm bg-gray-100"
            />
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700">
              Banner Name here
              <span class="text-xs text-gray-500">( Maximum 50 characters )</span>
            </label>
            <input
              type="text"
              placeholder="--Enter Name here--"
              maxlength="50"
              [(ngModel)]="bannerNameWholesale"
              class="mt-1 pl-3 h-10 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"
            />
          </div>

      <div>
        <label class="block text-sm font-medium text-gray-700">
          Image
          <span class="text-xs text-gray-500"
            >( Suggested Dimension : 1200 × 451 px )</span
          >
        </label>

        <div
          class="mt-2 flex items-center justify-center border-2 border-dashed border-blue-400 rounded-md p-6 text-center text-blue-500 cursor-pointer bg-blue-50 hover:bg-blue-100 relative"
          (drop)="onDropWholesale($event)"
          (dragover)="onDragOver($event)"
          (dragleave)="onDragLeave($event)"
          [class.bg-blue-100]="isDragOver"
        >
          <input
          type="file"
          accept="image/png, image/jpeg"
          class="hidden"
          id="fileUpload"
          (change)="onFileSelectedWholesale($event)"
          />
          <label
            for="fileUpload"
            class="cursor-pointer w-full h-full flex flex-col items-center justify-center"
          >
            <ng-container *ngIf="selectedWholesaleImageUrl; else placeholder">
              <div class="flex flex-col items-center">
                <img
                [src]="selectedWholesaleImageUrl"
                  alt="Preview"
                  class="max-h-48 rounded-md object-contain"
                />
                <p
                  class="mt-2 text-sm text-gray-600 dark:text-gray-300 truncate max-w-xs"
                >
                {{ selectedFileWholesale?.name }}
                </p>
              </div>
            </ng-container>
            <ng-template #placeholder>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-10 w-10 mb-2"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M7 16V4m0 0L4 7m3-3l3 3M17 16v-6m0 0l-3 3m3-3l3 3M4 20h16"
                />
              </svg>
              <p class="text-sm">
                <span class="font-medium"
                  >Select a JPG / PNG file to upload</span
                >
                <br />
                or drag and drop it here
              </p>
            </ng-template>
          </label>
        </div>
      </div>

      <!-- <div>
        <label class="block text-sm font-medium text-gray-700">
          Image
          <span class="text-xs text-gray-500"
            >( Suggested Dimension : 1200 × 450 px )</span
          >
        </label>
        <div
          class="mt-2 flex items-center justify-center border-2 border-dashed border-blue-400 rounded-md p-6 text-center text-blue-500 cursor-pointer bg-blue-50 hover:bg-blue-100 relative"
          (drop)="onDropWholesale($event)"
          (dragover)="onDragOver($event)"
          (dragleave)="onDragLeave($event)"
          [class.bg-blue-100]="isDragOver"
        >
          <input
            type="file"
            accept="image/png, image/jpeg"
            class="hidden"
            id="fileUpload"
            (change)="onFileSelectedWholesale($event)"
          />
          <label
            for="fileUpload"
            class="cursor-pointer w-full h-full flex flex-col items-center justify-center"
          >
            <ng-container *ngIf="selectedWholesaleImageUrl; else placeholder">
              <div class="flex flex-col items-center">
                <img
                  [src]="selectedWholesaleImageUrl"
                  alt="Preview"
                  class="max-h-48 rounded-md object-contain"
                />
                <p
                  class="mt-2 text-sm text-gray-600 dark:text-gray-300 truncate max-w-xs"
                >
                  {{ selectedFileWholesale?.name }}
                </p>
              </div>
            </ng-container>
            <ng-template #placeholder>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-10 w-10 mb-2"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M7 16V4m0 0L4 7m3-3l3 3M17 16v-6m0 0l-3 3m3-3l3 3M4 20h16"
                />
              </svg>
              <p class="text-sm">
                <span class="font-medium"
                  >Select a JPG / PNG file to upload</span
                >
                <br />
                or drag and drop it here
              </p>
            </ng-template>
          </label>
        </div>
      </div> -->



      <div class="flex justify-end space-x-2 pt-4">
        <button
          class="px-4 py-2 rounded-md text-sm font-medium bg-gray-300 text-gray-800 hover:bg-gray-400"
          (click)="cancelUploadWholesale()"
        >
          Cancel
        </button>
        <button
          class="px-4 py-2 rounded-md text-sm font-medium bg-indigo-600 text-white hover:bg-indigo-700"
          (click)="uploadBannerWholesale()"
        >
          Upload
        </button>
      </div>
    </div>
  </div>
</div>
